<html>

<head>
    <script src="/web3.min.36b8356b.js"></script>
</head>

<body>
    <input type="button" value="Allow" onclick="javascript: approveTx();">
    <input type="button" value="Withdraw" onclick="javascript: withdrawTest();">

    <script>function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7() {
  var PeetPayContract, WETHContractAddr, wetheabi, web3, wethContract, peetPayContract, approveTx, testPaypeet, withdrawTest;
  return regeneratorRuntime.wrap(function _callee7$(_context7) {
    while (1) {
      switch (_context7.prev = _context7.next) {
        case 0:
          _context7.next = 2;
          return window.ethereum.enable();

        case 2:
          PeetPayContract = '0xaD7A177296DCF8b9e3B220aDAD5074F64f3A5D86';
          WETHContractAddr = '0xc778417E063141139Fce010982780140Aa0cD5Ab';
          wetheabi = [{
            "constant": true,
            "inputs": [],
            "name": "name",
            "outputs": [{
              "name": "",
              "type": "string"
            }],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          }, {
            "constant": false,
            "inputs": [{
              "name": "_spender",
              "type": "address"
            }, {
              "name": "_value",
              "type": "uint256"
            }],
            "name": "approve",
            "outputs": [{
              "name": "",
              "type": "bool"
            }],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "function"
          }, {
            "constant": true,
            "inputs": [],
            "name": "totalSupply",
            "outputs": [{
              "name": "",
              "type": "uint256"
            }],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          }, {
            "constant": false,
            "inputs": [{
              "name": "_from",
              "type": "address"
            }, {
              "name": "_to",
              "type": "address"
            }, {
              "name": "_value",
              "type": "uint256"
            }],
            "name": "transferFrom",
            "outputs": [{
              "name": "",
              "type": "bool"
            }],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "function"
          }, {
            "constant": true,
            "inputs": [],
            "name": "decimals",
            "outputs": [{
              "name": "",
              "type": "uint8"
            }],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          }, {
            "constant": true,
            "inputs": [{
              "name": "_owner",
              "type": "address"
            }],
            "name": "balanceOf",
            "outputs": [{
              "name": "balance",
              "type": "uint256"
            }],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          }, {
            "constant": true,
            "inputs": [],
            "name": "symbol",
            "outputs": [{
              "name": "",
              "type": "string"
            }],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          }, {
            "constant": false,
            "inputs": [{
              "name": "_to",
              "type": "address"
            }, {
              "name": "_value",
              "type": "uint256"
            }],
            "name": "transfer",
            "outputs": [{
              "name": "",
              "type": "bool"
            }],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "function"
          }, {
            "constant": true,
            "inputs": [{
              "name": "_owner",
              "type": "address"
            }, {
              "name": "_spender",
              "type": "address"
            }],
            "name": "allowance",
            "outputs": [{
              "name": "",
              "type": "uint256"
            }],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
          }, {
            "payable": true,
            "stateMutability": "payable",
            "type": "fallback"
          }, {
            "anonymous": false,
            "inputs": [{
              "indexed": true,
              "name": "owner",
              "type": "address"
            }, {
              "indexed": true,
              "name": "spender",
              "type": "address"
            }, {
              "indexed": false,
              "name": "value",
              "type": "uint256"
            }],
            "name": "Approval",
            "type": "event"
          }, {
            "anonymous": false,
            "inputs": [{
              "indexed": true,
              "name": "from",
              "type": "address"
            }, {
              "indexed": true,
              "name": "to",
              "type": "address"
            }, {
              "indexed": false,
              "name": "value",
              "type": "uint256"
            }],
            "name": "Transfer",
            "type": "event"
          }];
          web3 = new Web3(window.ethereum);
          wethContract = web3.eth.contract(wetheabi);
          peetPayContract = web3.eth.contract([{
            "inputs": [],
            "stateMutability": "nonpayable",
            "type": "constructor"
          }, {
            "anonymous": false,
            "inputs": [{
              "indexed": true,
              "internalType": "address",
              "name": "_from",
              "type": "address"
            }, {
              "indexed": false,
              "internalType": "uint256",
              "name": "deposit",
              "type": "uint256"
            }, {
              "indexed": false,
              "internalType": "uint256",
              "name": "_value",
              "type": "uint256"
            }, {
              "indexed": false,
              "internalType": "uint256",
              "name": "currentBonus",
              "type": "uint256"
            }],
            "name": "PriceEstimated",
            "type": "event"
          }, {
            "inputs": [],
            "name": "uniswapRouter",
            "outputs": [{
              "internalType": "contract IUniswapV2Router02",
              "name": "",
              "type": "address"
            }],
            "stateMutability": "view",
            "type": "function",
            "constant": true
          }, {
            "inputs": [{
              "internalType": "address",
              "name": "withdrawWallet",
              "type": "address"
            }],
            "name": "withdraw",
            "outputs": [],
            "stateMutability": "payable",
            "type": "function",
            "payable": true
          }, {
            "inputs": [{
              "internalType": "address",
              "name": "withdrawWallet",
              "type": "address"
            }, {
              "internalType": "address",
              "name": "tokenAddr",
              "type": "address"
            }],
            "name": "withdrawSpecificToken",
            "outputs": [],
            "stateMutability": "payable",
            "type": "function",
            "payable": true
          }, {
            "inputs": [{
              "internalType": "uint256",
              "name": "_amount",
              "type": "uint256"
            }],
            "name": "transferToken",
            "outputs": [],
            "stateMutability": "payable",
            "type": "function",
            "payable": true
          }, {
            "inputs": [],
            "name": "getCurrentSaleBonus",
            "outputs": [{
              "internalType": "uint256",
              "name": "bonusPercent",
              "type": "uint256"
            }],
            "stateMutability": "view",
            "type": "function",
            "constant": true
          }]);

          approveTx = /*#__PURE__*/function () {
            var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {
              var tokenContractInstance;
              return regeneratorRuntime.wrap(function _callee2$(_context2) {
                while (1) {
                  switch (_context2.prev = _context2.next) {
                    case 0:
                      tokenContractInstance = wethContract.at(WETHContractAddr);
                      console.log(tokenContractInstance.events);
                      web3.eth.getAccounts( /*#__PURE__*/function () {
                        var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(error, accounts) {
                          var amount;
                          return regeneratorRuntime.wrap(function _callee$(_context) {
                            while (1) {
                              switch (_context.prev = _context.next) {
                                case 0:
                                  // Send ERC20 transaction with web3
                                  console.log(tokenContractInstance.functions);
                                  amount = web3.toWei(0.02, "ether");
                                  tokenContractInstance.approve(PeetPayContract, amount, function () {
                                    testPaypeet();
                                  }); //tokenContractInstance.approve()

                                case 3:
                                case "end":
                                  return _context.stop();
                              }
                            }
                          }, _callee);
                        }));

                        return function (_x, _x2) {
                          return _ref3.apply(this, arguments);
                        };
                      }());

                    case 3:
                    case "end":
                      return _context2.stop();
                  }
                }
              }, _callee2);
            }));

            return function approveTx() {
              return _ref2.apply(this, arguments);
            };
          }();

          window.approveTx = approveTx;

          testPaypeet = /*#__PURE__*/function () {
            var _ref4 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {
              var peetPayContractInstance, amount;
              return regeneratorRuntime.wrap(function _callee3$(_context3) {
                while (1) {
                  switch (_context3.prev = _context3.next) {
                    case 0:
                      peetPayContractInstance = peetPayContract.at(PeetPayContract);
                      console.log(peetPayContract);
                      amount = web3.toWei(0.02, "ether");
                      peetPayContractInstance.transferToken(amount, function (err, res) {
                        console.log(err);
                        console.log(res);
                      });

                    case 4:
                    case "end":
                      return _context3.stop();
                  }
                }
              }, _callee3);
            }));

            return function testPaypeet() {
              return _ref4.apply(this, arguments);
            };
          }();

          window.testPaypeet = testPaypeet;

          withdrawTest = /*#__PURE__*/function () {
            var _ref5 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {
              var peetPayContractInstance;
              return regeneratorRuntime.wrap(function _callee5$(_context5) {
                while (1) {
                  switch (_context5.prev = _context5.next) {
                    case 0:
                      peetPayContractInstance = peetPayContract.at(PeetPayContract);
                      web3.eth.getAccounts( /*#__PURE__*/function () {
                        var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(error, accounts) {
                          return regeneratorRuntime.wrap(function _callee4$(_context4) {
                            while (1) {
                              switch (_context4.prev = _context4.next) {
                                case 0:
                                  peetPayContractInstance.withdraw(accounts[0], function (err, res) {});

                                case 1:
                                case "end":
                                  return _context4.stop();
                              }
                            }
                          }, _callee4);
                        }));

                        return function (_x3, _x4) {
                          return _ref6.apply(this, arguments);
                        };
                      }());

                    case 2:
                    case "end":
                      return _context5.stop();
                  }
                }
              }, _callee5);
            }));

            return function withdrawTest() {
              return _ref5.apply(this, arguments);
            };
          }();

          window.withdrawTest = withdrawTest;
          window.onload = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {
            return regeneratorRuntime.wrap(function _callee6$(_context6) {
              while (1) {
                switch (_context6.prev = _context6.next) {
                  case 0:
                  case "end":
                    return _context6.stop();
                }
              }
            }, _callee6);
          }));

        case 15:
        case "end":
          return _context7.stop();
      }
    }
  }, _callee7);
}))();</script>
</body>

</html>